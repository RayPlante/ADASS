
\resetcounters

\markboth{Song, Luo, and Zhao}{A New Python Library --- PydasLib}

\title{A New \ssindex{computer languages!Python}Python Library for Spectroscopic Analysis with \ssindex{packages!MIDAS}MIDAS Style}
\author{Yihan~Song,$^{1,2}$ Ali~Luo,$^{1,2}$ and Yongheng~Zhao$^{1,2}$
\affil{$^1$Key Laboratory of Optical Astronomy, Nationsal Astronomical obervatories, Chinese Academy of Sciences, 20A Datun Road, Chaoyang District, Beijing, 100012, China}
\affil{$^2$National Astronomical Observatories, Chinese Academy of Sciences,20A Datun Road, Chaoyang District, Beijing, 100012, China}
}

\aindex{Song, Y.}
\aindex{Luo, A.}
\aindex{Zhao, Y.}

\begin{abstract}
The ESO \ssindex{packages!MIDAS}MIDAS is a system for astronomers to analyze data which many astronomers are using. \ssindex{computer languages!Python}Python is a high level script language and there are many applications for astronomical data process. We are releasing a new \ssindex{computer languages!Python}Python library which realizes some \ssindex{packages!MIDAS}MIDAS commands in \ssindex{computer languages!Python}Python. People can use it to write a \ssindex{packages!MIDAS}MIDAS style \ssindex{computer languages!Python}Python code. We call it \ssindex{libraries!PydasLib}PydasLib. It is a \ssindex{computer languages!Python}Python library based on ESO \ssindex{packages!MIDAS}MIDAS functions, which is easily used by astronomers who are familiar with the usage of \ssindex{packages!MIDAS}MIDAS.
\end{abstract}

	  \section{Introduction}
\ssindex{computer languages!Python}Python is a popular language, wildly used in astronomical programming now. More and more researchers use \ssindex{computer languages!Python}Python to realize their algorithms and ideas for astronomical data processing. 

\ssindex{packages!MIDAS}MIDAS is an outstanding programming language for astronomy. It is created and maintained by by European Organization for Astronomical Research in the Southern Hemisphere (ESO). There are many good codes written in \ssindex{packages!MIDAS}MIDAS and many people have been many using it for years.
\ooindex{ESO-MIDAS, ascl:1302.017}

We are releasing a new \ssindex{computer languages!Python}Python library which realizes some \ssindex{packages!MIDAS}MIDAS commands in \ssindex{computer languages!Python}Python. People can use it to write a \ssindex{packages!MIDAS}MIDAS style \ssindex{computer languages!Python}Python code. We call it \ssindex{libraries!PydasLib}PydasLib. Our work here can help two kinds of people:
\begin{itemize}
   \item \ssindex{computer languages!Python}Python users who want to migrate some \ssindex{packages!MIDAS}MIDAS code to \ssindex{computer languages!Python}Python. 
   \item \ssindex{packages!MIDAS}MIDAS users who want to use \ssindex{computer languages!Python}Python to realize their idea using commands which they are familiar with.
\end{itemize}


          \section{\ssindex{packages!MIDAS}MIDAS and \ssindex{computer languages!Python}Python}
\subsection{ESO \ssindex{packages!MIDAS}MIDAS}

ESO \ssindex{packages!MIDAS}MIDAS is a system which provides general tools for \ssindex{software!image processing}image processing and data reduction with an emphasis on astronomical applications including imaging and special reduction packages. Many astronomy researchers use this system to achieve their thoughts and algorithms on data analysis. \ssindex{packages!MIDAS}MIDAS supports many basic data types and functions such as fitting, statistics on tables and images, etc. It can also display images and output the results to a file or on a screen.

There are four shortcomings of \ssindex{packages!MIDAS}MIDAS:
\begin{itemize}
  \item  Data structure in \ssindex{packages!MIDAS}MIDAS is not very flexible. The basic type of variable in \ssindex{packages!MIDAS}MIDAS can be integer, float or string. There is no list or dictionary in it. 
   \item  \ssindex{packages!MIDAS}MIDAS is a self-sealing system. The code can run very well in its environment but it is not able to be called by other programs. It is hard to write a function in \ssindex{packages!MIDAS}MIDAS which serves the whole software \ssindex{data!pipelines!reduction}pipeline. 
   \item  It is not convenient to run \ssindex{packages!MIDAS}MIDAS code  in parallel.    You need to select parallel mode in the system to run another \ssindex{packages!MIDAS}MIDAS program at the same time. Nowadays, with a great deal of data  springing up, how long will a program take will be considerable.  
    \item \ssindex{packages!MIDAS}MIDAS can not be installed in Windows which limits its applications. 
\end{itemize}

          \subsection{Python}
\ssindex{computer languages!Python}Python is an interpreted, general-purpose high-level programming language with a design philosophy which emphasizes code readability. It supports several programming paradigms which include functional, object oriented, and imperative programming styles. It features automatic memory management as well as a fully dynamic type system \citep{python_web}. 

          \subsection{PyMidas}
\ssindex{libraries!PyMidas}PyMidas has been a product of the ESO project Sampo since 2005. It is an interface for \ssindex{computer languages!Python}Python to call \ssindex{packages!MIDAS}MIDAS programs. Because the precondition of using \ssindex{libraries!PyMidas}PyMidas is that \ssindex{packages!MIDAS}MIDAS should be installed, it is hard to use under different operation system.

          \section{\ssindex{libraries!PydasLib}PydasLib --- Our Work}
In \ssindex{libraries!PydasLib}PydasLib, we fulfill dozens of \ssindex{packages!MIDAS}MIDAS commands in \ssindex{computer languages!Python}Python. The goal of our work is to make a \ssindex{computer languages!Python}Python library which can achieve the functions of some \ssindex{packages!MIDAS}MIDAS commands. Using this library, people can write their algorithms in \ssindex{computer languages!Python}Python without \ssindex{packages!MIDAS}MIDAS or migrate their favorite \ssindex{packages!MIDAS}MIDAS code to \ssindex{computer languages!Python}Python. The code can be easily called by other programs under different operation system. 

	  \subsection{\ssindex{libraries!PydasLib}PydasLib Commands and Corresponding \ssindex{packages!MIDAS}MIDAS Commands}
Table \ref{commands} shows \ssindex{libraries!PydasLib}PydasLib commands and the corresponding \ssindex{packages!MIDAS}MIDAS commands. The functions of \ssindex{libraries!PydasLib}PydasLib commands are almost as same as the corresponding \ssindex{packages!MIDAS}MIDAS ones. Table \ref{new-commands} shows new commands which are not included in \ssindex{packages!MIDAS}MIDAS. 

\begin{table}[!hb]
\begin{center}
\caption{Commands list}
\label{commands}
\begin{tabular}{cc||cc}
\hline
 \ssindex{libraries!PydasLib}PydasLib & \ssindex{packages!MIDAS}MIDAS &PydasLib & MIDAS\\
\hline
\hline
 centerGauss & center/gauss &
computeFit & compute/fit \\
computeImage & compute/fit &
computeTable & compute/table\\
convertTable & convert/table  &
convolveImage & convolve/image\\
copyDD & copy/dd &
copyDK & copy/dk\\
copyIT & copy/it &
copyTable & copy/table\\
cp & cp &
createColumn & create/column\\
createImage & create/image &
createTable & create/table\\
deleteColumn & delete/column &
deleteDescriptor & delete/descriptor\\
deleteTable & delete/table &
exists & exists \\
extractImage & extract/image &
fitImage & fit/image\\
fitTable & fit/table &
insertImage & insert/image\\
intapeFits & intape/fits &
interpolateTI & interpolate/ti\\
mergeTable & merge/table &
nameColumn & name/column\\
outputi & outputi &
outputr & outputr\\
overplot & overplot &
plot & plot\\
readImage & read/image &
renameTable & rename/table\\
selectFunction & select/function &
selectTable & select/table\\
sortTable & sort/table &
statisticsImage & statistics/image\\
statisticsTable & statistics/table &
value &value \\
writeDescriptor & write/descriptor\\
\hline 
\hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[!hb]
\begin{center}
\caption{New Commands list}
\label{new-commands}
\begin{tabular}{c|c}
\hline
 \ssindex{libraries!PydasLib}PydasLib & Comments\\
\hline 
\hline
 add\_fit  & add a fitting function to the fitting file\\
del\_fit & remove a fitting function from the fitting file \\
get\_global\_key & get a handle of a image, table or fitting file\\
savefig &  save the figure as a file\\
valid\_row & return a list of valid rows of the table\\
\hline
\hline
\end{tabular}
\end{center}
\end{table}
          \section{Example }
Table \ref{code} shows a short example. The example uses \ssindex{libraries!PydasLib}PydasLib to read a Sloan FITS file, to make a convolution with a gaussian profile and to extract H$\alpha$ emission lines. Finally, the example saves the plotted figures (see Figure~\ref{fig}) into files.

\begin{table}[!hb]
\begin{center}
\caption{Example Code}
\label{code}
\begin{tabular}{cl}
lineno & code\\
\hline
8 & intapeFits(1, "Sloa", "data.fit")  \\
14 & spsl0001 = extractImage (Sloa0001, [1, npixsloan, 1], type='pixel', \\
  & name="spsl0001")\\
29 & redshift = copyDK('Sloa0001', 'Z')  \\
45 & name\_zzero = convertTable ('name\_zzero', [spsl\_tab,'lambda\_zero',\\
   & 'fluxdens'], refmidsloan, 'spline')\\
48 & plot(name\_zzero)\\
56 & conv = convolveImage(img1, psf, 'conv') \\
57 & plot(conv)\\
61 & halpha = extractImage (name\_zzero, [6500,6630],name="halpha") \\
62 & plot(halpha)\\
\end{tabular}
\end{center}
\end{table}
	 
\begin{figure}[!hb]
\begin{center}
\caption{Figures of the example}
\label{fig}
\includegraphics[width=1.\textwidth, height=.2\textheight]{part9/Song_P65/spectra}\\

\includegraphics[width=.46\textwidth]{part9/Song_P65/part}
\includegraphics[width=.46\textwidth]{part9/Song_P65/halpha}\\
The top one is the whole spectrum. Left bottom one is the spectrum after convolution by a Gaussian kernel. Right bottom one is a H$\alpha$ emission line.
\end{center}
\end{figure}
	  \section{Summary}
We introduce a new library for \ssindex{computer languages!Python}Python which can realize some functions of ESO's \ssindex{packages!MIDAS}MIDAS package. Using this library, people who are used to the grammar of \ssindex{packages!MIDAS}MIDAS can keep their customs and enjoy the power of \ssindex{computer languages!Python}Python. This library is for \ssindex{astronomy!spectral analysis}\ssindex{software!spectral analysis}spectral analysis. Since this is the first version of the library, not all the functions and commands of \ssindex{packages!MIDAS}MIDAS are included. In the future, the library will be better.

\bibliographystyle{asp2010}
\bibliography{editor}
