
\resetcounters

\bibliographystyle{asp2010}

\markboth{Mink}{15 Years of RVSAO}

\title{The Past 15 Years of \ssindex{packages!RVSAO}RVSAO}
\author{Jessica Mink}
\affil{Smithsonian Astrophysical Observatory, 60 Garden St., Cambridge, MA 02138}

\aindex{Mink, J.}

\begin{abstract}
Since the last paper describing the \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} \ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} radial velocity package was published almost 15 years ago, this collection of tasks dealing with wavelength-shifted spectra has continued to grow and evolve. Many changes have been made to improve robustness and accuracy in the \textbf{xcsao} cross-correlation and \textbf{emsao} emission line fitting tasks. Two new tasks, \textbf{pxcsao} and \textbf{pemsao}, find radial velocities using the same methods, but save the results as task parameters, making them easier to use in CL scripts.  Spectra can now be cross-correlated in pixel or wavelenth space as well as velocity space.  A major task, \textbf{eqwidth}, based on the \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} \textbf{bands} task, computes equivalent widths in \ssindex{astronomy!redshift}redshifted spectra. \textbf{sumspec}, which rebins, normalizes, re-redshifts, sums, and/or stacks spectra, has proven to be useful in multi-fiber \ssindex{spectrograph}spectrograph reduction \ssindex{data!pipelines!reduction}pipelines.  \textbf{listspec} lists spectra in a variety of user-selected formats, and several CL scripts plot spectra with labeled emission and absorption lines. 

\end{abstract}

\section{\ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} Package}

The \ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} package was developed at the Smithsonian Astrophysical Observatory to compute velocities of stars and galaxies for a variety of astrophysical projects.  The first version of the \textbf{xcsao} cross-correlation task was described at the first ADASS meeting in 1991 \citep{xcsao_1991}, and the workings of the \textbf{emsao} emission line fitting task were presented three years later \citep{1995ASPC...77..496M}. By the time a paper describing the entire package was written \citep{1998PASP..110..934K} it had progressed to version 2.0 and was being used in the \ssindex{instruments!individual!FAST}FAST \ssindex{spectrograph}spectrograph \ssindex{data!pipelines!reduction}pipeline \citep{1997ASPC..125..140T}.  Since then, the package has been used in \ssindex{data!pipelines!reduction}pipelines for the Hectospec \citep{2007ASPC..376..249M} and TRES \citep{2011ASPC..442..305M} \ssindex{spectrograph}spectrographs and for a search through the 1,500,000 spectra of the \ssindex{surveys!Sloan Digital Sky Survey (SDSS)}Sloan Digital Sky Survey to create an atlas of S stars \citep{2011AAS...21715303O}.  These uses have required new capabilities and improved the robustness of the code and algorithms.  Several new tasks and ways of using the package will be briefly described.

Documentation and \ssindex{software!source code}source code are online at \url{http://tdc-www.harvard.edu/iraf/rvsao/}.

\section{New Task to Compute Equivalent Widths}

Based on the \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} \textbf{onedspec.bands} task \citep{1992ASPC...25..417V}, \textbf{eqwidth} computes equivalent widths and a variety of variations which provide information with which to compare emission and absorption lines between and within spectra.  Several standard band descriptions (center plus continuum samples) are included, as well as some defined by John Huchra, who helped signicantly with the algorithms and error computation.

Because it is often useful to compare strengths of emission lines in spectra where the measured continuum is often in the measurement noise, a flag can be set to return a scaled area in the line without a reference to the insignificant continuum.

The task can also \ssindex{astronomy!redshift}redshift band descriptions to work with unmodified spectra so the noise characteristics are preserved.  A lot of effort went into getting the errors correct as the formula in the literature didn't always seem to give reasonable numbers.  \textbf{eqwidth} is made to be run on many spectra at once, though limited interaction is possible.

\section{New Tasks to Return Results as Task Parameters}

In addition to those in the \textbf{xcsao} task, \textbf{pxcsao} adds parameters to return information about the best template fit for the last spectrum.  If there are multiple orders or apertures (specnum is a  range or list), a median velocity and error information are returned.

\textbf{pemsao} adds parameters to those in the \textbf{emsao} task to return line fit information for the last spectrum including the number of lines fit and information about the fit to the first emission line.  If there are multiple orders or apertures (specnum is a range or list), mean and median velocities and error information are returned.

\section{Using \ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} Tasks from a Unix Shell}

Most tasks of the \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} \ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} spectrum package may be run from the Unix/Linux command line almost as if you were inside \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002}. The parameters used come from the \ssindex{packages!IRAF}IRAF home directory defined by the \textit{irafhome} environment variable or the \ssindex{packages!IRAF}IRAF/ subdirectory of the user's home directory.

\texttt{bcvcorr~~~~Compute barycentric velocity correction}

\texttt{contpars~~~Set continuum fitting parameters for most tasks}

\texttt{contsum~~~~Set continuum fitting parameters for sumspec}

\texttt{emsao~~~~~~Find velocity shifts of emission lines in a spectrum}

\texttt{pemsao~~~~~Find velocity shifts of emission lines in a spectrum}

\texttt{emplot~~~~~Plot a spectrum labelling lines}

\texttt{ihelp~~~~~~Print help file of an \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} task}

\texttt{irafhelp~~~Print help file of an \ssindex{packages!IRAF}IRAF task}

\texttt{linespec~~~Make an emission line spectrum from a line list}

\texttt{listspec~~~List the spectrum in the specified format}

\texttt{\ssindex{packages!RVSAO}rvsao~~~~~~Type this message}\ooindex{RVSAO, ascl:9912.003}

\texttt{sumspec~~~~Add spectra, shift them, and/or remove continua}

\texttt{xcsao~~~~~~Cross-correlate a spectrum against templates}

\texttt{pxcsao~~~~~Cross-correlate a spectrum against templates}

If you type any task command with no arguments, you will get a simple help message with options for parameter access and more complete help, for example:

\texttt{XCSAO: Cross-correlate a spectrum against a set of templates}

\texttt{usage: xcsao spectrum [templates=xxx][other arguments]}

\texttt{~~~~~~~~~~~xcsao help for \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} help}

\texttt{~~~~~~~~~~~xcsao dpar to dump parameters}

\texttt{~~~~~~~~~~~xcsao epar to edit parameters}

\texttt{~~~~~~~~~~~xcsao lpar to list parameters}

where

\texttt{[task] dpar} dumps the parameters using \ssindex{packages!IRAF}IRAFs dpar as task.parameter = value

\texttt{[task] epar} edits the parameters using \ssindex{packages!IRAF}IRAFs eparam

\texttt{[task] help} opens \ssindex{packages!IRAF}IRAF\ooindex{IRAF, ascl:9911.002} help for the task

\texttt{[task] lpar} list the parameters using \ssindex{packages!IRAF}IRAFs lparam

\section{An Example Using Multiple Tasks}

Figure 1 shows an image of 9,795 galaxy spectra from the SHELS survey \citep{shels_2005} sorted from emission to absorption using several \ssindex{packages!RVSAO}RVSAO\ooindex{RVSAO, ascl:9912.003} tasks.

1.  Reduce spectra using Hectospec \ssindex{data!pipelines!reduction}pipeline

2.  Find \ssindex{astronomy!redshift}redshifts using \textbf{xcsao}, saving them in spectrum headers

3.  Compute equivalent widths of H-alpha emission lines with \textbf{eqwidth}.

4. Sort the output table by H-alpha equivalent width

5. Extract a list of pathnames from the sorted table

6. Read the sorted list of spectra with \textbf{sumspec}, shifting them to rest wavelength and stacking them into a \ssindex{data formats!FITS}FITS file from bright emission to deep absorption at H-alpha.

7. Convert to JPEG file using \ssindex{applications!DS9}ds9

%\articlefigure{P019a.eps}{Figure 1}{9,795 galaxy spectra sorted by H-alpha equivelent width}
\begin{figure}[!ht]
\plotfiddle{part9/Mink_P019/P019a.eps}{15cm}{0}{80}{80}{-100}{0}
\caption{9,795 galaxy spectra sorted by H-alpha equivalent width}
\end{figure}

\acknowledgements
I would like to thank all of the people who have used this package and helped it to be a more robust and capable set of software.  The late John Huchra was of great assistance in working the kinks out of the equivalent width task, and Susan Tokarz, Guilermo Torres, and Soren Meibom, whose offices are just down the hall from mine, have gotten most of the changes they requested.

\bibliography{editor}
