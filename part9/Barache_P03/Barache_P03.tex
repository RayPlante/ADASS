% This is the aspauthor.tex LaTeX file
% Copyright 2010, Astronomical Society of the Pacific Conference Series

\documentclass[11pt,twoside]{article}
\usepackage{asp2010}

\resetcounters
\aspcpryear{2012}
\aspvolume{TBD}
\aspvoltitle{ADASS XXII}
\aspvolauthor{Friedel, D. and Plante, R.}
\bibliographystyle{asp2010}

\markboth{C. Barache et al.}{VO-compatible Architecture for managing and processing images of moving celestial bodies}

\begin{document}

\title{VO-compatible Architecture for managing and processing images of moving celestial bodies : Application to the Gaia-GBOT project}
\author{C. Barache$^1$, S. Bouquillon$^1$, T. Carlucci$^1$, F. Taris$^1$, L. Michel$^2$, M. Altmann$^1$ $^3$\\
\affil{$^1$Observatoire de Paris / SyRTE / France}
\affil{$^2$Observatoire de Strasbourg / France}
\affil{$^3$Zentrum f\"{u}r Astronomie der Universit\"{a}t Heidelberg / ARI / Germany}}

\begin{abstract}
The Ground Based Optical Tracking (GBOT) group is a part of the “Data Processing and Analysis Consortium”, the large consortium of over 400 scientists from many European countries, charged with the scientific conduction of the Gaia mission by ESA. The GBOT group is in charge of the optical part of tracking of the Gaia satellite. This optical tracking is necessary to allow the Gaia mission to fully reach its goal in terms of astrometry precision level.  These observations will be done daily, during 5 years of the mission, with the use of optical CCD frames taken by a small network of 1-2m class telescopes located all over the world. The requirements for the accuracy on the satellite position determination, with respect of the stars in the field of view, are 20 mas. 
These optical satellite positions will be sent weekly by GBOT to the SOC of ESAC and used with other kinds of observations (radio ranging and Doppler) by MOC of ESOC to improve the Gaia ephemeris.\\ 
\hspace*{0.5cm}For this purpose, we developed a set of accurate astrometry reduction programs specially adapted for tracking moving objects. The inputs of these programs are for each tracked target an ephemeris and a set of fits images. The outputs are for each image: a file containing all information about the detected objects, a catalogue file used for calibration, a tiff file for visual explanation of the reduction result, and an improvement of the fits image header. The final result is an overview file containing only the data related to the target extracted from all the images. These programs are written in GNU fortran 95 and provide results in VOTable format (supported by Virtual Observatory protocols). All these results are sent automatically into the GBOT Database which is built with the SAADA freeware. The user of this Database can archive and query the data but also, thanks to the delegate option provided by SAADA, select a set of images and run directly the GBOT reduction programs with a dedicated Web interface. For more information about SAADA (an Automatic System for Astronomy Data Archive under gpl license and VO‑compatible) see the L. Michel related paper.
\end{abstract}

\section{What are the GBOT Tools?}
There are four differents tools useful for GBOT reduction : 
\begin{itemize}
\item The GBOT FIELD OF VIEW MAKER: a Web tool allowing observers to build a map of the Target Field of View with Target Trajectory and Ephemeris ( \url{http://gbot/fov/}). This tool is not described in this document.
\item The GBOT REDUCTION PIPELINE: a set of “images analyzing programs” specially developed for providing accurate astrometry of moving objects. 
\item The GBOT DATABASE to archive and query:
                \begin{itemize}
                \item the Images of tracked moving objects and the related observations parameters. 
                \item the Data used or produced by the Gbot Reduction Pipeline or by the Web-Pipeline (as the reduction parameters, results, statistics, ...)
                \item some visual previews and information useful to estimate the quality of observations and results.
                \end{itemize}  
\item The GBOT WEB-PIPELINE: a web interface to apply directly the Gbot Reduction Pipeline to a set of images selected from the Gbot Database.                                    
\end{itemize}


\section{The GBOT REDUCTION PIPELINE }
%This pipeline is mainly written in GNU Fortran 95 and provide results in VOTable format supported by VO protocols (Bouquillon et al., 2012).
This pipeline is mainly written in GNU Fortran 95 and provide results in VOTable format supported by VO protocols (~\cite{Bouquillon_2012}).
The pipeline is divided into seven main parts.
The Input are sets of Fits-Images of tracked targets and their Ephemeris.
\begin{itemize}
\item HeaderModif: to homogenizes Fits-Image Header.                               
\item FindSources: to detect and extract from a fits-image
all the sources brighter than a threshold value, and determines 
their pixel (i.e.x,y) positions using one of several fitting 
techniques which can be chosen by the user.                               
\item CatalogueMaker: to download the stars from a       
reference catalog corresponding to the Image Field of view
(based on “CDSCLIENT” tool from CDS Strasbourg).                              
\item AstroReduc: to link the stars of a reference catalog  
with the sources detected into the fits-images and to perform 
astrometric reduction.                             
\item TargetFinder: to find and improve the determination 
of Targets parameters
\item MakeTiff: to create a tiff preview of the images with
the stars used for calibration (based on a routine written by Jay Anderson).                      
\item MakeReductionOverview: to gather all the       
reduction parameters and results for a “night” in a same file.
\end{itemize}


\section{The GBOT DATABASE}
%This Database is built with the help of the SAADA freeware (an Astronomical Database Generator under gpl license and VO‑compatible, Michel L., 2012)
This Database is built with the help of the SAADA freeware (an Astronomical Database Generator under gpl license and VO‑compatible, ~\cite{Michel_2011})
After a basic validation process, all the new data useful for the GBOT project are inserted into this Database. These data are of three kinds:

$\bullet$ Observations (Images \& Parameters) (fits and Vo-Table files)

$\bullet$ Reduction process data (Parameters \& Results) (Vo-Table files)

$\bullet$ Useful related Information (Calibration preview, O-C plots, ...) (jpf files)
\newpage

\noindent These data are arranged into five main collections: 

\begin{itemize}
\item The FITSIMAGES collection contains the images of the target with Modified Header.
\item The SOURCES collection contains the Extracted Sources files produced by FindSources program.
\item The CATALOGS collection contains the Reference Stars files produced by CatalogueMaker program.
\item The SOLASTRO collection contains the Link between Sources and Stars, the Target parameters, the reduction Parameters and Results.
\item The OMCPLOT collection contains the plots Preview of the astrometric solution.\\
Relationships are built to linked the related data (for instance: to link a set of observations, with its astrometric results or with the calibration stars in the reference catalogs chosen).
\end{itemize}

These data are easily selected by users using SAADA Web interface with mouse click or with SAADAQL (“data-mining” query langage) panel. \\
The Data selected by Web users can be exported using 3 way :\\
\begin{itemize}
\item Using card icon and click on download cart button to exported them into a zip file on user computer
\item Using card icon and click on “delegate option” (see details in part 4)
\item Using WebSamp button ("VO-Paris Data Centre's WebSampConnector toolkit.“) to sent the data to VO tools as Aladin or Topcat.
\end{itemize}
\hspace*{0.25cm}In Fig.1 you see the  first version of GBOT database (can be tested at \url{http://gbotone-se.obspm.fr:8080/dbgbot3})

\section{The GBOT WEB-PIPELINE}
The user can access to the GBOT Web Interface by selecting one set of observations among the SOLASTRO tables
in the GBOT Database and by using the “delegate option” provided by the last version of SAADA
(see the L. Michel related presentation). From this interface two options are available for the user :
\begin{itemize}
\item Local download of the selected observations into the GBOT Server
(for example to process these data later or using its own tools).\\
\item Run GBOT Web Pipeline online to re-reduce this set of observations
(these new results can be inserted into the GBOT Database after a GBOT administrator validation).
\end{itemize}

\section{Conclusion}
The main features of interest of this architecture  are for the GBOT Pipeline :\\
\hspace*{0.25cm}- availability of a large set of centroids algorithms well-adapted to moving objects\\
\hspace*{0.25cm}- some robust estimators for the position error \\
\hspace*{0.25cm}- can be used independently of GBOT Database and Web Pipeline.\\\\
For the GBOT Database : \\
\hspace*{0.25cm}- powerful tools to select and export data compatible with VO protocols \\
\hspace*{0.25cm}-“delegate option” allowing export data into a user own web interface.

\begin{figure}[ht]
\epsscale{0.25}
\plotone{P03.fig2.eps}
\caption{GBOT Database with SAADA Web Interface} \label{P03-fig-1}
\end{figure}



\acknowledgements 
We thank VO Paris Data Centre and CDS de Strasbourg for their technical and financial support.


%\begin{references}
%\reference{1}, Bouquillon S. et al. ,2012, ACM, LPI Contribution No. 1667, id.6100
%\reference{2}, Michel L., 2011, Astrophysics Source Code Library, record  asll:1111.003
%\end{references}
\bibliography{P03}

\end{document}
